<?xml version="1.0" encoding="utf-8"?>
<xforms>
    <xform desc="传感器管理" id="sensormanage">
        <xhandle desc="首页显示的传感器" id="sensorshowlist" rtnype="JSON">
            <xsql id="a1" list="true" page="true" tpe="SQL" tpl="select * from  t_sensor  WHERE show=1 and @CONDITION" var="rs">
                <xflt id="CONDITION" nrp="" tpl="@pid">
                    <xfltpara id="pid" nrp="1=1" para="pid" sql="l_comaddr in (select comaddr from t_baseinfo where pid=':pid')"> 
                    </xfltpara>         
                </xflt>        
            </xsql>   
        </xhandle> 
         
        <xhandle desc="添加传感器" id="addsensor" rtnype="JSON">
            <xsql id="a1" para="l_comaddr,name,dreg,informationnum,sitenum,worktype,unit" tpe="DDL" tpl="insert into t_sensor(l_comaddr,name,dreg,informationnum,sitenum,worktype,unit) values(':l_comaddr',':name',':dreg',':informationnum',':sitenum',':worktype',':unit') " var="rs">
            </xsql>
        </xhandle>    
         
        <xhandle desc="删除项目表" id="deletesensor" rtn="rs" rtnype="JSON">
            <xsql id="a1" tpe="DDL" tpl="delete from t_sensor where @CONDITION " var="rs">
                <xflt id="CONDITION" tpl="@id ">
                    <xfltpara id="id" nrp="1=1" para="id" sql="id =  :id ">
                    </xfltpara>
                </xflt>
            </xsql>
        </xhandle>
        
        
        <xhandle desc="修改传感器" id="updsensor" rtn="rs" rtnype="JSON">
            <xsql id="a1" para="dreg,informationnum,name,sitenum,worktype,unit" tpe="DDL" tpl="update t_sensor set dreg = ':dreg',informationnum=':informationnum',name=':name',sitenum=':sitenum',worktype=':worktype',unit=':unit' where  @CONDITION " var="rs">
                <xflt id="CONDITION" nrp="" tpl="@id ">
                    <xfltpara id="id" nrp="1=1" para="id" sql="id=:id">
                    </xfltpara>
                </xflt>
            </xsql>
        </xhandle> 
        
        <xhandle desc="首页显示传感器" id="showsensor" rtn="rs" rtnype="JSON">
            <xsql id="a1" para="" tpe="DDL" tpl="update t_sensor set show =1 where  @CONDITION " var="rs">
                <xflt id="CONDITION" nrp="" tpl="@id ">
                    <xfltpara id="id" nrp="1=1" para="id" sql="id=:id">
                    </xfltpara>
                </xflt>
            </xsql>
        </xhandle> 
                                                                                                    
    </xform>
    
</xforms>
